# Проектная работа "Веб-ларек"

## Стек:
* HTML;
* SCSS;
* TS;
* Webpack;
* ООП.

## Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

## Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/styles/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Описание проекта
Проект "Веб-ларек" реализует пример типового интернет магазина, в данном случае для продажи цифровых товаров. Пользователь может просматривать список товаров, посмотреть детальную информацию о каждом товаре, положить заинтересовавший его товар в корзину и оформить покупку. Проект реализован на TypeScript и представляет собой SPA (Single Page Application) с использованием API для получения данных о товарах.

## Описание интерфейса
Интерфейс можно условно разделить на 3 процесса:
Просмотр списка товаров, просмотр детальной информации о товаре и оформление заказа.
Так как модальные окна в проекте однотипные, то их общая логика и структура вынесена в абстрактный класс ModalScreen. Все модальные окна наследуются от него и переопределяют методы для своих нужд.

### Архитектура проекта (MVC)
Реализована единая модель данных приложения AppState, содержащая всю логику работы с данными и возможные действия над ними. Все изменения данных происходят через методы модели.
Экземпляр модели передается в контроллеры, которые по факту являются обработчиками пользовательских действий и обновляют состояние модели через ее методы.
Экземпляры контроллеров передаются в качестве объекта содержащего обработчики событий в верхнеуровневые отображения (экраны).
При обработке событий производится обновление данных в верхнеуровневых отображениях. Экраны это фактически крупные сборки инкапсулирующие детали реализации интерфейса и принимающие из вне только обработчики событий и необходимые данные. Экраны внутри составлены из более мелких отображений, которые инициализируют с помощью глобальных настроек проекта и распределяют данные между вложенными отображениями через свойства и метод render().
И таким образом соединяем между собой все компоненты приложения.

### Отображения
Отображения в проекте разделены на три типа:
common — общие компоненты, не зависящие от доменной области проекта
partial — частичные компоненты, реализующие доменную область проекта
screen — верхнеуровневые компоненты, которые являются экранами приложения
Первые два типа (common и partial) независимо типизированы, не используют глобальных настроек напрямую и могут быть легко переносимы между проектами. Экраны (screen) же зависят от глобальных настроек и используют их для инициализации и передачи данных между вложенными отображениями, так как по факту это соединительный код для удобства вынесенные в отдельные файлы и оформленный как отображение.

### Модели
Модели в проекте представлены классом AppState, который содержит в себе все данные и логику работы с ними. Модель частично реализует паттерн "Наблюдатель", и уведомляет об изменениях через метод onChange(changes: AppStateChanges). Для удобства работы с данными в модели реализованы методы для изменения данных, которые в свою очередь вызывают метод onChange().

### Контроллеры
Контроллеры находятся в разработке.

### Интерфейсы
**1. Интерейс API**  
1.1 ProductItem - интерфейс описывает объект товара, содержит информацию о товаре: id - uuid товара, description - описание; image - картинка; title: название; category: категория; price: цена.  
1.2 ProductList - интерфейс описывает объект Список товаров, содержит информацию: total - количество товааров; items - список объектов товаров.  
1.3 OrderRequest - интерфейс описывает объект post-запроса на оформление заказа, содержит информацию: payment - способ оплаты; address - адрес доставки; email - почта покупателя; phone - телефон покупателя; total - полная стоимость заказа; items - список id товаров в заказе.  
1.4 OrderResponse - интерфейс описывает объект ответа сервера при успешном оформлении заказа, содержит информацию: id - uuid заказа; total - полная стоимость заказа.  
1.5 ResponseError - интерфейс описывает объект ответа сервера при неуспешном оформлении заказа (4ХХ), содержит информацию: error - текст ошибки.  
1.6 ProductAPI - Интерфейс API-клиента, содержит методы: getProduct - загружает список продуктов с сервера; orderProducts - отправляет запрос на покупку товаров на сервер.  
**2. Интерфейсы отображения**  
2.1 ProductCard - интерфейс карточки товара в списке на главной странице, предназначен для типизации данных товара: id - uuid товара, image - картинка; title: название; category: категория; price: цена.  
2.2 Product - интерфейс товара в модальном окне детализации, предназначен для типизации данных товара: id - uuid товара, description - описание; image - картинка; title: название; category: категория; price: цена.  
2.3 ProductMini - интерфейс карточки товара в корзине, предназначен для типизации данных товара: id - uuid товара, title: название; price: цена.  
2.4 OrderPayAddr - интерфейс данных по оплате и доставке, предназначен для типизации данных по оплате и доставке заказа: payment - способ оплаты; address - адрес доставки.  
2.5 UserInfo - интерфейс данных пользователя, предназначен для типизации данных покупателя: email - почта; phone - телефон.  
2.6 MainData - интерфейс Главная страница, предназначен для типизации данных, выводимых на главной странице: counter - счетчик товаров в корзине; items - список карточек товаров типа ProductCard.  
2.7 MainSettings - интерфейс действий пользователя на главной странице, содержит методы: onOpenBasket - открывает модальное окно с корзиной заказа; onOpenProduct - открывает модальное окно с детальной информацией о товаре.  
2.8 ProductData - интерфейс модального окна товара, предназначен для типизации данных, выводимых в модальном окне товара: item - объект товара типа Product.  
2.9 ProductSettings - интерфейс действий пользователя в модальном окне товара, содержит методы: addProductBasket - добавляет товар в корзину; onClose - закрывает модальное окно.  
2.10 BasketData - интерфейс модального окна Корзины, предназначен для типизации данных, выводимых в модальном окне корзины: items - список товаров в заказе с типом ProductMini.  
2.11 BasketSettings - интерфейс действий пользователя в модальном окне корзины, содержит методы: onRemove - удалить товар из корзины; onClose - закрыть модальное окно; onNext - продолжить оформление.  
2.12 OrderData - интерфейс модального окна настроек заказа, предназначен для типизации данных, вводимых пользователем: item - объект типа OrderPayAddr(выбор способа оплаты и ввод адреса доставки).  
2.13 OrderSettings - интерфейс действий пользователя в модальном окне оформления заказа, содержит методы: onClose - закрыть окно; onNext - продолжить оформление заказа.  
2.14 UserData - интерфейс модального окна настроек заказа, предназначен для типизации данных, вводимых пользователем: item - объект типа UserInfo(ввод email и телефона).  
2.15 UserSettings - интерфейс действий пользователя в модальном окне оформления заказа, содержит методы: onClose - закрыть окно; onNext - продолжить оформление заказа.  
2.16 SuccessSettings -  интерфейс действий пользователя в модальном окне успешного оформления заказа, содержит методы: onClose - закрыть окно; onBackMain - редирект на главную страницу.  
2.17 ModalScreenSettings - интерфейс действий пользователя в любом модальном окне:  
onClose - закрыть;
onNext - продолжить.  
**3. Модель данных приложения, содержит:**  
**Поля:**  
products - Загружаемые с сервера данные о товаре;  
payaddr, contacts - Заполняемые пользователем данные;  
basket - Корзина с товарами;  
order - Заказ;  
openedModal - Состояние интерфейса (открыто модальное окно);  
isOrderReady - Состояние интерфейса (заказ оформлен);  
modalMessage - Состояние интерфейса (Сообщение);  
isError - Состояние интерфейса (ощ=шибка);  
**Методы:**  
loadProducts() - загружает список товров с сервера;  
loadProduct(id) - загружает информацию о товаре;  
orderProducts(order) - отправляет информацию о товаре на сервер;  
restoreState() - Действия с localStorage;  
persistState() - Действия с localStorage;  
**Пользовательские действия:**  
removeProduct(id) - удаляет товар из корзины;  
fillPayAddr(payaddr) - вводит данные по оплате и адрес;  
fillContacts(contacts) - вводит данные: почту и телефон;  
isValidContacts() - валидация введенных пользоателем контактных данных;  
openModal() - открывает модальное окно;  
setMessage() - оставляет сообщение.  
